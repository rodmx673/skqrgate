<script>
        // URL ACTUALIZADA CORRECTAMENTE (EFPLG50)
        const MI_LINK_SERVIDOR = "https://script.google.com/macros/s/AKfycbzVSH0B6Gd--cgQAwaYHJtIVD63JKLl1WkgJiK-ux63JaEL-m_nKdps8k63EFPLG50/exec";

        async function ejecutarLogin() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            const btn = document.getElementById('btnLogin');

            if(!email || !password) return alert("⚠️ Por favor, ingresa tus credenciales.");

            btn.innerText = "VERIFICANDO...";
            btn.disabled = true;

            try {
                // PASO 1: Intentar login en la pestaña TUTORES
                const responseTutor = await fetch(`${MI_LINK_SERVIDOR}?action=loginTutor&email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`);
                const resTutor = await responseTutor.json();

                if(resTutor.status === "success") {
                    const sessionData = {
                        ...resTutor,
                        rol: "Tutor",
                        email: email
                    };
                    localStorage.setItem('userSession', JSON.stringify(sessionData));
                    
                    // Ajustado a resTutor.nombre para que coincida con el servidor
                    alert("✅ Bienvenido Tutor: " + resTutor.nombre); 
                    window.location.href = 'dashboard-tutor.html';
                    return;
                }

                // PASO 2: Intentar login en USUARIOS (Alumnos/Directores)
                const responseGral = await fetch(`${MI_LINK_SERVIDOR}?action=login&email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`);
                const resGral = await responseGral.json();

                if(resGral.status === "success") {
                    localStorage.setItem('userSession', JSON.stringify(resGral));
                    alert("✅ Acceso correcto como " + resGral.rol);

                    if(resGral.rol === "Director") {
                        window.location.href = 'monitor-director.html';
                    } else if(resGral.rol === "Alumno") {
                        window.location.href = 'dashboard-alumno.html';
                    } else {
                        alert("Sesión iniciada como: " + resGral.rol);
                    }
                } else {
                    alert("❌ Credenciales incorrectas. Verifica tus datos.");
                    btn.innerText = "ENTRAR";
                    btn.disabled = false;
                }

            } catch (e) {
                console.error("Error de Login:", e);
                alert("❌ Error de conexión con el servidor.");
                btn.innerText = "ENTRAR";
                btn.disabled = false;
            }
        }
    </script>